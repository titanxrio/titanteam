<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Titan Leaks</title>
  <!-- Linking the CSS -->
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- NAVIGATION WITH DISCORD BUTTON -->
  <nav>
    <div class="nav-title">Titan Leaks</div>
    <!-- Adjust your Discord invite link here -->
    <a class="discord-btn" href="https://discord.gg/YOUR-INVITE-LINK" target="_blank">Join Discord</a>
  </nav>

  <!-- HEADER SECTION -->
  <header>
    <h1>LEAKS & FILES</h1>
    <p>Here you'll find the latest files:</p>
  </header>

  <!-- DYNAMIC FILE LIST -->
  <ul id="fileList"></ul>

  <script>
    const repo = "titanxrio/titanteam";  // Your GitHub repository
    const branch = "main";               // Branch name
    const folder = "";                   // Folder (leave empty for root)

    document.addEventListener("DOMContentLoaded", fetchFiles);

    async function fetchFiles() {
      try {
        const response = await fetch(
          `https://api.github.com/repos/${repo}/contents/${folder}?ref=${branch}`
        );
        const files = await response.json();
        const fileList = document.getElementById("fileList");
        fileList.innerHTML = "";

        for (const file of files) {
          // Ignore index.html & style.css
          if (
            file.type === "file" &&
            file.name !== "index.html" &&
            file.name !== "style.css"
          ) {
            const li = document.createElement("li");

            // Fetch last commit date (without time)
            const commitDate = await fetchFileDate(file.path);
            // Just the date (MM/DD/YYYY) in US-English style for example
            const displayDate = commitDate
              ? new Date(commitDate).toLocaleDateString("en-US")
              : "unknown";

            li.innerHTML = `
              <div class="upload-date">Uploaded: ${displayDate}</div>
              <a class="download-btn" href="${file.download_url}" download>
                ${file.name}
              </a>
            `;
            fileList.appendChild(li);
          }
        }
      } catch (error) {
        console.error("Error loading files:", error);
      }
    }

    // Retrieve the last commit date for each file
    async function fetchFileDate(path) {
      try {
        const commitsUrl = `https://api.github.com/repos/${repo}/commits?path=${encodeURIComponent(path)}&sha=${branch}&per_page=1`;
        const response = await fetch(commitsUrl);
        const commitData = await response.json();
        if (commitData && commitData.length > 0) {
          return commitData[0].commit.author.date;
        }
      } catch (err) {
        console.error("Error loading commit date:", err);
      }
      return null;
    }
  </script>
</body>
</html>
